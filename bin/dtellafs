#!/usr/bin/env ruby

require 'rubygems'
require 'bundler/setup'
require 'dtellafs'

t = Time.now - 100

class HelloDir
  def contents(path)
    puts "contents: #{path}"
    ['hello.txt']
  end
  def size(path)
    puts "sizing: #{path}"
    read_file(path).size
  end
  def file?(path)
    puts "file?: #{path}"
    path == '/hello.txt'
  end
  def read_file(path)
    puts "reading: #{path}"
    "Hello, World!\n"
  end
  
  def respond_to? *args
    # puts "respond_to?: #{args.inspect}"
    super
  end
  
  def atime *args
    t
  end
  
  def ctime *args
    t
  end
  
  def mtime *args
    t
  end
end

hellodir = HelloDir.new
FuseFS.set_root( hellodir )

# Mount under a directory given on the command line.
FuseFS.mount_under File.expand_path(ARGV.shift)
FuseFS.run
